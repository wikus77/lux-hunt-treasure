
<!-- üîê Codice indipendente - FIRMATO: BY JOSEPH MUL√à ‚Äî CEO di NIYVORA KFT‚Ñ¢ -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="x-pwa-version" content="2025.01.18.001">
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/icon-m1-192x192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icons/icon-m1-512x512.png" />
  <link rel="apple-touch-icon" href="/icons/icon-m1-192x192.png" />
  <link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous" />
    <meta name="theme-color" content="#0A0B14" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  
    <meta charset="UTF-8" />
    <!-- PWA iOS Safari Critical Meta Tags - Enhanced Native Feel -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="M1SSION‚Ñ¢" />
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover, interactive-widget=resizes-content" />
    
    <title>M1SSION - La sfida inizia presto</title>
    
    <!-- Favicon M1SSION‚Ñ¢ - ¬© 2025 Joseph MUL√â -->
    <meta name="theme-color" content="#0A0B14" />
    
    <!-- Script per reindirizzare HTTP a HTTPS - mobile compatible -->
    <script>
      // Redirect HTTP to HTTPS except on localhost and Capacitor
      if (window.location.protocol === 'http:' && 
          !window.location.hostname.match(/localhost|127.0.0.1/) &&
          window.location.protocol !== 'capacitor:') {
        window.location.href = window.location.href.replace('http:', 'https:');
      }
    </script>
    
    <!-- Plausible Analytics - Script principale attivo -->
    <script defer data-domain="m1ssion.com" src="https://plausible.io/js/script.outbound-links.tagged-events.js"></script>
    <script>
      window.plausible = window.plausible || function () {
        (window.plausible.q = window.plausible.q || []).push(arguments);
      };
    </script>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=VT323&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300;400;500;600;700;800;900&display=swap">
    <meta name="description" content="Discover Europe's most mysterious app. The game starts soon." />
    <meta name="author" content="M1SSION Team" />

    <!-- Open Graph / Instagram / Facebook -->
    <meta property="og:title" content="M1SSION‚Ñ¢ ‚Äì Global Launch" />
    <meta property="og:description" content="Discover Europe's most mysterious app. The game starts soon." />
    <meta property="og:image" content="https://m1ssion.eu/og-m1ssion-banner.jpg" />
    <meta property="og:url" content="https://m1ssion.eu" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="M1SSION‚Ñ¢" />
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="M1SSION‚Ñ¢ ‚Äì Global Launch" />
    <meta name="twitter:description" content="Discover Europe's most mysterious app. The game starts soon." />
    <meta name="twitter:image" content="https://m1ssion.eu/og-m1ssion-banner.jpg" />
    <meta name="twitter:site" content="@m1ssion_game" />
    
    <!-- Google Analytics 4 (condizionale tramite Cookie Script) -->
    <script type="text/plain" data-type="text/javascript" data-name="google-analytics" async src="https://www.googletagmanager.com/gtag/js?id=G-9824MZJZ63" crossorigin="anonymous"></script>
    <script type="text/plain" data-name="google-analytics">
      window.dataLayer = window.dataLayer || [];
      function gtag(){ dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'G-9824MZJZ63');
    </script>
    
    <!-- Cookie Script CMP - aggiornato per HTTPS -->
    <script type="text/plain" charset="UTF-8" src="https://cdn.cookie-script.com/s/2db074620da1ba3a3cc6c19025d1d99d.js"></script>
    <script type="text/plain" charset="UTF-8" data-cookiescriptreport="report" src="https://report.cookie-script.com/r/2db074620da1ba3a3cc6c19025d1d99d.js"></script>
    
    
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <script type="module" crossorigin src="/assets/index.B1pZJRDR.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/react-vendor.CAU3V3le.js">
  <link rel="modulepreload" crossorigin href="/assets/ui-vendor.DoN6OTIp.js">
  <link rel="modulepreload" crossorigin href="/assets/three-vendor.wwSanNQ8.js">
  <link rel="modulepreload" crossorigin href="/assets/supabase-vendor.CghLtY7N.js">
  <link rel="modulepreload" crossorigin href="/assets/animation-vendor.Bezovbgp.js">
  <link rel="modulepreload" crossorigin href="/assets/map-vendor.Dz2XYzxS.js">
  <link rel="modulepreload" crossorigin href="/assets/stripe-vendor.BaJG9Xy1.js">
  <link rel="modulepreload" crossorigin href="/assets/router-vendor.opNAzTki.js">
  <link rel="stylesheet" crossorigin href="/assets/index.CsOi6RkJ.css">
</head>

  <body>
    <div id="root"></div>
    
    <!-- üî• STRIPE GLOBAL SHIM - Previene errori "getStripe is not defined" + Pages.dev ENV -->
    <script>
      (function () {
        // Anti ReferenceError se vecchi chunk chiamano getStripe troppo presto
        if (!window.getStripe) {
          window.getStripe = function () { 
            console.warn('‚ö†Ô∏è getStripe called before initialization - returning null');
            return null; 
          };
        }
        
        // Pages.dev ENV propagation per Stripe PK
        if (window.ENV && window.ENV.VITE_STRIPE_PUBLISHABLE_KEY && !window.STRIPE_PK) {
          window.STRIPE_PK = window.ENV.VITE_STRIPE_PUBLISHABLE_KEY;
          console.log('‚úÖ Stripe PK propagated from Pages.dev ENV');
        }
        
        // Debug helper per Pages.dev
        if (location.hostname.includes('.pages.dev')) {
          console.log('üåê Pages.dev environment detected');
          window.DEBUG_PAGES = true;
        }
      })();
    </script>
    
    <!-- ¬© 2025 Joseph MUL√â ‚Äì M1SSION‚Ñ¢ ‚Äì ALL RIGHTS RESERVED ‚Äì NIYVORA KFT‚Ñ¢ -->
    <!-- Additional Stripe Shim for Enhanced Fallback -->
    <script>
      // ¬© 2025 M1SSION‚Ñ¢ NIYVORA KFT ‚Äì Joseph MUL√â - Stripe Shim Globale
      window.getStripe = window.getStripe || function() {
        console.warn('[STRIPE-SHIM] getStripe chiamato prima dell\'inizializzazione - usa getStripeSafe()');
        return Promise.resolve(null);
      };
      
      // Propaga VITE_STRIPE_PUBLISHABLE_KEY se disponibile  
      if (!window.__STRIPE_PK__ && typeof window !== 'undefined') {
        try {
          // Fallback per Cloudflare Pages - cerca in window.ENV se presente
          const envKey = window.ENV?.VITE_STRIPE_PUBLISHABLE_KEY;
          if (envKey && typeof envKey === 'string' && envKey.startsWith('pk_')) {
            window.__STRIPE_PK__ = envKey;
            console.log('[STRIPE-SHIM] ‚úÖ PK propagato da window.ENV');
          }
        } catch (e) {
          console.warn('[STRIPE-SHIM] ‚ö†Ô∏è Fallback PK non trovato in window.ENV');
        }
      }
    </script>
    
    <!-- Service Worker Registration (production only) -->
    <script>
      // ¬© 2025 M1SSION‚Ñ¢ NIYVORA KFT ‚Äì Joseph MUL√â
      (function () {
        try {
          if (location.hostname === 'm1ssion.eu' && 'serviceWorker' in navigator && !window.__swRegistered) {
            window.__swRegistered = true;
            navigator.serviceWorker.register('/sw.js', { scope: '/', updateViaCache: 'none' })
              .then(r => console.log('[SW] ‚úÖ Registered:', r.scope))
              .catch(err => {
                const errStr = String(err?.message || err || '');
                if (errStr.includes('503') || errStr.includes('ERR_FAILED') || errStr.includes('failed to fetch')) {
                  console.warn('[SW] ‚ö†Ô∏è Registration warning (503/network):', errStr);
                } else {
                  console.error('[SW] ‚ùå', err);
                }
              });
          }
        } catch (e) {
          console.warn('[SW] skipped:', e);
        }
      })();
    </script>
  </body>
</html>
