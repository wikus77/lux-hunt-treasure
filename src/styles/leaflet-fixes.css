
/* CRITICAL LEAFLET FIXES FOR CAPACITOR iOS - COMPLETE SOLUTION */

/* Import Leaflet CSS */
@import 'leaflet/dist/leaflet.css';

/* CRITICAL: Fix for missing marker icons in production */
.leaflet-default-icon-path {
  background-image: url('https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png');
}

/* CRITICAL: Container sizing with proper height management */
.leaflet-container,
.leaflet-container-fixed {
  width: 100% !important;
  height: 100% !important;
  min-height: 70vh !important;
  position: relative !important;
  outline: none !important;
  background: #1a1a1a !important;
  overflow: hidden !important;
  display: block !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* CRITICAL: Tile pane positioning and rendering */
.leaflet-tile-pane {
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  z-index: 200 !important;
  opacity: 1 !important;
  visibility: visible !important;
}

/* CRITICAL: Individual tile rendering fixes */
.leaflet-tile {
  opacity: 1 !important;
  visibility: visible !important;
  filter: brightness(0.6) contrast(1.2) !important;
  image-rendering: auto !important;
  image-rendering: crisp-edges !important;
  image-rendering: -webkit-optimize-contrast !important;
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  max-width: none !important;
  max-height: none !important;
}

/* CRITICAL: Map pane structure */
.leaflet-map-pane {
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  z-index: auto !important;
  width: 100% !important;
  height: 100% !important;
}

/* CRITICAL: Overlay layers positioning */
.leaflet-overlay-pane {
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  z-index: 400 !important;
}

/* CRITICAL: Controls positioning */
.leaflet-control-container {
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  z-index: 1000 !important;
}

/* CRITICAL: Attribution dark theme */
.leaflet-control-attribution {
  background-color: rgba(0, 0, 0, 0.8) !important;
  color: white !important;
  font-size: 10px !important;
}

/* CRITICAL: iOS Capacitor touch handling */
.leaflet-container {
  touch-action: manipulation !important;
  -webkit-touch-callout: none !important;
  -webkit-user-select: none !important;
  user-select: none !important;
}

/* CRITICAL: Parent container fixes for MapPage */
.m1ssion-glass-card .leaflet-container,
.m1ssion-glass-card .leaflet-container-fixed {
  min-height: 70vh !important;
  height: 100% !important;
}

/* CRITICAL: Prevent CSS conflicts */
.leaflet-container *,
.leaflet-container-fixed * {
  box-sizing: border-box !important;
}

/* CRITICAL: Ensure visibility of all leaflet elements */
.leaflet-container canvas,
.leaflet-container svg,
.leaflet-container-fixed canvas,
.leaflet-container-fixed svg {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
}

/* CRITICAL: Fix for tile loading and caching */
.leaflet-tile-container {
  opacity: 1 !important;
  visibility: visible !important;
}

.leaflet-tile-container img {
  opacity: 1 !important;
  visibility: visible !important;
  filter: brightness(0.6) contrast(1.2) !important;
}

/* CRITICAL: SafeArea integration */
@supports (padding: env(safe-area-inset-top)) {
  .leaflet-container-fixed {
    padding-top: env(safe-area-inset-top, 0px);
    padding-bottom: env(safe-area-inset-bottom, 0px);
    padding-left: env(safe-area-inset-left, 0px);
    padding-right: env(safe-area-inset-right, 0px);
  }
}

/* CRITICAL: Zoom controls styling for iOS */
.leaflet-control-zoom {
  -webkit-touch-callout: none !important;
  touch-action: manipulation !important;
}

.leaflet-control-zoom a {
  background-color: rgba(0, 0, 0, 0.8) !important;
  color: white !important;
  border: 1px solid rgba(0, 209, 255, 0.3) !important;
}

.leaflet-control-zoom a:hover {
  background-color: rgba(0, 209, 255, 0.2) !important;
}
