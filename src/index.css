@import './styles/qr-pulse.css';
/* ğŸ” FIRMATO: BY JOSEPH MULÃˆ â€” CEO di NIYVORA KFTâ„¢ */
/* M1SSIONâ„¢ - Custom Design System & Styles */
/* Complete visual identity with custom glassmorphism effects and M1SSION branding */

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700&display=swap');
@import './styles/theme.css';
@import './styles/mobile-optimizations.css';
@import './styles/ios-safe-area-fixes.css';
@import './styles/ios-native.css';
@import './styles/norah-modal.css';
@import './styles/prize-modal.css';
@import './styles/map-dock.css';
@import './styles/portal-container.css';
@import './styles/animations/index.css';
@import './styles/apple-glass.css';
@import './styles/native-app-upgrade.css'; /* ğŸš€ NATIVE APP UI UPGRADE - Rollback: rimuovere questa riga */

@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&display=swap');

@import './styles/m1-glass.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  .font-orbitron {
    font-family: "Orbitron", sans-serif;
  }
}

:root {
  --m1-header-bg: #0a0b0f;
  --m1-header-bg-gradient: linear-gradient(180deg, rgba(10, 11, 20, 0.85) 0%, rgba(10, 11, 20, 0.85) 100%);
  --header-height: 72px;
  --bottom-nav-height: 54px;
  --app-header-height: 72px;
  --app-bottom-nav-height: 64px;
  --m1-bottom-nav: 96px; /* Fallback height for bottom navigation */
}

@layer base {
  /* ğŸ¨ SFONDO GRADIENTE M1SSION - Effetto cyberpunk visibile */
  html {
    @apply text-white;
    min-height: 100vh;
    min-height: 100dvh;
    min-height: -webkit-fill-available;
    overflow-x: hidden !important;
    -webkit-text-size-adjust: 100%;
    /* GRADIENTE POTENZIATO - piÃ¹ visibile */
    background:
      radial-gradient(ellipse 1200px 800px at 85% -10%, rgba(0, 229, 255, 0.35), transparent 50%),
      radial-gradient(ellipse 1000px 700px at -15% 25%, rgba(123, 46, 255, 0.30), transparent 50%),
      radial-gradient(ellipse 800px 500px at 50% 90%, rgba(252, 30, 255, 0.15), transparent 45%),
      linear-gradient(180deg, #0a0b0f 0%, #0c0e14 25%, #0e1118 50%, #0a0c10 75%, #080a0d 100%) !important;
    background-attachment: fixed !important;
    /* ğŸ”¥ FIX: Nascondi scrollbar */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  
  html::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }
  
  body {
    @apply text-white;
    background: transparent !important;
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden !important;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    padding: 0 !important;
    margin: 0 !important;
    /* ğŸ”¥ FIX: Nascondi scrollbar */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  
  body::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }
  
  #root {
    min-height: 100vh;
    min-height: 100dvh;
    background: transparent !important;
    /* ğŸ”¥ FIX: Nascondi scrollbar */
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  
  #root::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }
  
  /* ğŸ”¥ FIX GLOBALE: Nascondi tutte le scrollbar nell'app */
  *::-webkit-scrollbar {
    display: none;
    width: 0;
    height: 0;
  }
  
  * {
    scrollbar-width: none;
    -ms-overflow-style: none;
  }
  
  /* ğŸ¨ SFONDO GRADIENTE M1SSION - Gestito inline in App.tsx */
  .m1-fullscreen-bg {
    /* Stili inline in App.tsx */
  }

  /* Norah AI Panel body scroll lock */
  body.m1-no-scroll {
    overflow: hidden !important;
  }

  /* Emergency fallback for iOS PWA - matches m1-app-bg */
  html.ios-pwa-fallback {
    background: #0a0b0f !important;
    background-color: #0a0b0f !important;
  }
  
  html.ios-pwa-fallback * {
    color: white !important;
  }

  .app-shell {
    position: relative;
    min-height: 100vh !important;
    min-height: 100dvh !important;
    background: transparent !important;
  }

  /* ğŸ¨ FIX: Forza trasparenza SOLO sui container principali dell'app */
  .safe-area-wrapper {
    background: transparent !important;
  }
  
  .global-layout-content {
    background: transparent !important;
  }
  
  /* Container m1-app-bg trasparente per mostrare gradiente html */
  .m1-app-bg {
    background: transparent !important;
  }

  /* ios-safe-top - NASCOSTO per permettere allo sfondo di estendersi */
  .ios-safe-top {
    display: none !important;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: "Orbitron", sans-serif;
    @apply font-semibold tracking-wide text-gradient-text;
  }

  h1 { @apply text-3xl md:text-4xl mb-6; }
  h2 { @apply text-2xl md:text-3xl mb-4; }
  h3 { @apply text-xl md:text-2xl mb-3; }
  h4 { @apply text-lg md:text-xl mb-2; }

  .content-container {
    @apply m1ssion-glass-card my-4 rounded-xl;
  }

  @media (max-width: 640px) {
    button, a {
      /* was: @apply touch-manipulation mobile-touch-target; */
      touch-action: manipulation;
      min-height: 44px;
      min-width: 44px;
    }

    input, select, textarea {
      /* was: @apply text-base mobile-optimized; */
      font-size: 16px;
    }

    .content-section {
      @apply px-3 py-4;
    }
  }
}

@layer components {
  /* Toast slide animation - scende dall'alto centrato */
  @keyframes toast-slide-down {
    0% {
      opacity: 0;
      transform: translateY(-30px) scale(0.9);
    }
    100% {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  /* Override per sonner toast container */
  .toaster {
    position: fixed !important;
    top: calc(env(safe-area-inset-top, 47px) + 20px) !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: 450px !important;
    max-width: 90vw !important;
  }
  
  /* Toast styling override */
  .toaster [data-sonner-toast] {
    animation: toast-slide-down 0.5s cubic-bezier(0.16, 1, 0.3, 1) !important;
    min-height: 48px !important;
    margin: 0 auto !important;
    left: 0 !important;
    right: 0 !important;
    transform: none !important;
  }
  
  /* Page hero spacing adjustments */
  .page .page-hero {
    margin-top: 0;
    padding-top: clamp(12px, 2.2vh, 20px);
  }

  .page {
    padding-top: calc(env(safe-area-inset-top) + var(--header-height) + 8px);
  }

  .page-content {
    padding-top: calc(var(--header-height) + env(safe-area-inset-top) + 16px);
  }

  .glass-card {
    @apply bg-white/10 backdrop-blur-md border border-white/10;
    border-radius: 16px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2),
                inset 0 2px 3px rgba(255, 255, 255, 0.06);
    transition: all 0.25s ease-in-out;
  }

  /* .m1ssion-glass-card now defined in theme.css for 3D Obsidian + Aurora effect */

  .glass-card:hover {
    @apply bg-white/10;
    box-shadow: 0 8px 38px rgba(0, 0, 0, 0.3),
                inset 0 2px 5px rgba(255, 255, 255, 0.08);
  }

  .btn-gradient {
    @apply bg-gradient-to-r from-[#7B2EFF] to-[#00D1FF] text-white font-medium py-3 px-6 rounded-full;
    box-shadow: 0 4px 15px rgba(123, 46, 255, 0.3);
    transition: all 0.3s ease;
  }

  .btn-gradient:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(123, 46, 255, 0.5);
  }

  .btn-gradient:active {
    transform: translateY(1px);
  }

  .neon-button {
    @apply btn-gradient;
  }

  .press-effect {
    transition: all 0.1s ease-in-out;
  }

  .press-effect:active {
    transform: scale(0.95);
  }

  .touch-manipulation {
    touch-action: manipulation;
  }

  .line-glow {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(to right, transparent, #00E5FF, transparent);
    opacity: 0.4;
  }

  /* Pulse animation for Final Shot marker */
  @keyframes heartbeat {
    0% { transform: scale(1); opacity: 1; }
    25% { transform: scale(1.1); opacity: 0.9; }
    50% { transform: scale(1.2); opacity: 0.8; }
    75% { transform: scale(1.1); opacity: 0.9; }
    100% { transform: scale(1); opacity: 1; }
  }

  .pulsing-red-marker {
    animation: heartbeat 2s ease-in-out infinite;
  }

  /* Intelligence panel scrolling fixes */
  .intelligence-scroll-container {
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    max-height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 160px);
  }

  .intelligence-scroll-container::-webkit-scrollbar {
    display: none;
  }

  /* Custom scrollbar for Battle Console and other components */
  .custom-scrollbar::-webkit-scrollbar {
    width: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
    border-radius: 3px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, #FC1EFF 0%, #00D1FF 100%);
    border-radius: 3px;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, #FF00FF 0%, #00FFFF 100%);
  }

  /* Ensure all content is scrollable on iOS */
  .full-scroll-viewport {
    min-height: calc(100dvh - env(safe-area-inset-top) - env(safe-area-inset-bottom) - 80px);
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: calc(env(safe-area-inset-bottom) + 100px);
  }

  /* iOS Safari viewport fixes */
  @supports (height: 100dvh) {
    .full-height-container {
      height: 100dvh;
    }
    
    .min-h-screen-dvh {
      min-height: 100dvh;
    }
    
    .h-screen-dvh {
      height: 100dvh;
    }
  }
  
  /* Fallback for browsers without dvh support */
  @supports not (height: 100dvh) {
    .min-h-screen-dvh {
      min-height: 100vh;
    }
    
    .h-screen-dvh {
      height: 100vh;
    }
  }

  .dynamic-island {
    position: relative;
    overflow: visible;
    background: linear-gradient(to bottom, #1a1a1a, #0d0d0d);
    border-radius: 28px;
    box-shadow:
      inset 0 1px 3px rgba(255, 255, 255, 0.05),
      0 4px 12px rgba(0, 0, 0, 0.4);
    transition: none;
  }

  .dynamic-code {
    font-weight: 600;
    text-shadow: 0 0 2px rgba(0, 255, 255, 0.3);
  }

  .mobile-px {
    @apply px-3 sm:px-6;
  }

  .mobile-py {
    @apply py-3 sm:py-4;
  }

  .mobile-space-y {
    @apply space-y-3 sm:space-y-4;
  }

  .bottom-nav-item {
    @apply flex flex-col items-center justify-center transition-colors;
  }

  .bottom-nav-item.active {
    @apply text-white;
  }

  .bottom-nav-item:not(.active) {
    @apply text-gray-400;
  }

  .form-input {
    @apply bg-black/60 border border-white/10 rounded-lg p-3 text-white w-full;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
  }

  .form-label {
    @apply text-sm text-white/80 mb-1 block;
  }

  .feature-card {
    @apply glass-card p-5 transition-transform duration-300 hover:-translate-y-1;
  }

  .badge {
    @apply inline-flex items-center justify-center px-2 py-1 text-xs font-medium rounded-full;
  }

  .badge-primary {
    @apply bg-gradient-to-r from-[#7B2EFF] to-[#00D1FF] text-white;
  }

  .badge-secondary {
    @apply bg-white/10 text-white;
  }

  /* â€”â€”â€” M1SSIONâ„¢ Brand Title â€”â€”â€” */
  .plans-title { 
    line-height: 1.15 !important; 
    @apply text-4xl font-bold mb-4;
  }
  .brand-m1 {
    color: #00E5FF !important;
    font-weight: 800 !important;
    letter-spacing: 0.5px !important;
    text-shadow: 0 0 8px rgba(0,229,255,.8) !important;
  }
  .brand-ss { 
    color: #FFFFFF !important; 
    font-weight: 800 !important; 
  }

  /* â€”â€”â€” Ribbon visibili â€”â€”â€” */
  .pricing-section, .plans-wrapper, .plans-grid, .plan-card { 
    overflow: visible !important; 
  }
  .plans-grid, 
  .plans-wrapper, 
  .pricing-section { 
    overflow: visible !important; 
    position: relative; 
  }
  .plan-card { 
    overflow: visible !important; 
    position: relative; 
    z-index: 0; 
  }
  .plan-card .ribbon {
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 50;
    pointer-events: none;
    padding: 6px 12px;
    border-radius: 999px;
    font-weight: 700;
    font-size: 12px;
    filter: drop-shadow(0 2px 6px rgba(0,0,0,.5));
    white-space: nowrap;
  }
  .plan-card.gold .ribbon { 
    background: #FFDD33; 
    color: #1A1A1A; 
  }
  .plan-card.titanium .ribbon { 
    background: #9B59FF; 
    color: white; 
  }

  /* â€”â€”â€” Free button loading â€”â€”â€” */
  .free-cta[disabled] { 
    opacity: .6 !important; 
    cursor: not-allowed !important; 
  }
}

@layer utilities {
  .scale-130 {
    transform: scale(1.3);
  }

  .animate-glow {
    animation: glow 0.6s ease-in-out forwards;
  }

  @keyframes glow {
    from {
      opacity: 0;
      text-shadow: none;
    }
    to {
      opacity: 1;
      text-shadow: 0 0 2px rgba(0, 255, 255, 0.3);
    }
  }

  .glow {
    animation: glow 0.6s ease-in-out forwards;
  }

  .glow-text {
    text-shadow: 0 0 10px rgba(0, 209, 255, 0.6);
    animation: glow-pulse 3s ease-in-out infinite;
  }

  @keyframes glow-pulse {
    0%, 100% { text-shadow: 0 0 10px rgba(0, 209, 255, 0.6); }
    50% { text-shadow: 0 0 20px rgba(0, 209, 255, 0.8), 0 0 30px rgba(0, 209, 255, 0.4); }
  }

  .safe-padding-x {
    padding-left: max(1rem, env(safe-area-inset-left));
    padding-right: max(1rem, env(safe-area-inset-right));
  }

  .safe-padding-bottom {
    padding-bottom: max(1.25rem, env(safe-area-inset-bottom));
  }

  .tap-target {
    @apply min-h-[44px] min-w-[44px];
  }

  .gradient-text {
    @apply bg-gradient-to-r from-white to-white/80 bg-clip-text text-transparent;
  }

  .gradient-text-cyan {
    @apply bg-gradient-to-r from-[#00D1FF] to-[#7B2EFF]/80 bg-clip-text text-transparent;
  }

  .text-gradient-text {
    @apply gradient-text;
  }
}

/* Fix per overflow orizzontale */
.container, .max-w-4xl, .max-w-6xl, .max-w-7xl {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
  padding-left: env(safe-area-inset-left, 1rem);
  padding-right: env(safe-area-inset-right, 1rem);
}

@media (min-width: 640px) {
  .container, .max-w-4xl, .max-w-6xl, .max-w-7xl {
    max-width: calc(100vw - 2rem);
  }
}

@media (min-width: 1024px) {
  .max-w-4xl {
    max-width: 56rem;
  }

  .max-w-6xl {
    max-width: 72rem;
  }

  .max-w-7xl {
    max-width: 80rem;
  }
}

@media (max-width: 640px) {
  .mobile-content-spacing {
    padding: 0.75rem;
    margin-bottom: 1rem;
  }

  h1, h2, h3 {
    word-break: break-word;
  }
}

.app-card {
  @apply glass-card p-4 sm:p-6;
}

.section-spacing {
  @apply my-4 sm:my-6;
}

.transition-standard {
  @apply transition-all duration-300 ease-in-out;
}

/* âœ… Enhanced Bottom Navigation for PWA iOS */
.bottom-nav {
  --bar-h: var(--bottom-nav-height);
  height: calc(var(--bar-h) + env(safe-area-inset-bottom));
  padding-bottom: max(env(safe-area-inset-bottom), 6px);
  backdrop-filter: blur(10px);
  background: var(--m1-header-bg-gradient);
}

.bottom-nav .item {
  min-height: 44px;
  gap: 4px;
}

.bottom-nav .icon {
  width: 22px;
  height: 22px;
}

.bottom-nav .label {
  font-size: 11px;
  line-height: 14px;
}

.bottom-navigation-fix {
  position: fixed !important;
  bottom: 0px !important;
  left: 0 !important;
  right: 0 !important;
  height: calc(var(--bottom-nav-height) + env(safe-area-inset-bottom)) !important;
  z-index: 9999 !important;
  transform: translateZ(0) !important;
  background: var(--m1-header-bg-gradient) !important;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  isolation: isolate !important;
  padding-bottom: max(env(safe-area-inset-bottom), 6px);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ¨ M1SSIONâ„¢ SFONDO GRADIENTE - PRIORITÃ€ MASSIMA (FUORI DA @LAYER)
   Questo blocco DEVE stare alla FINE del file per avere prioritÃ  massima
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

html {
  background:
    radial-gradient(ellipse 1200px 800px at 85% -10%, rgba(0, 229, 255, 0.35), transparent 50%),
    radial-gradient(ellipse 1000px 700px at -15% 25%, rgba(123, 46, 255, 0.30), transparent 50%),
    radial-gradient(ellipse 800px 500px at 50% 90%, rgba(252, 30, 255, 0.15), transparent 45%),
    linear-gradient(180deg, #0a0b0f 0%, #0c0e14 25%, #0e1118 50%, #0a0c10 75%, #080a0d 100%) !important;
  background-attachment: fixed !important;
  background-color: #0a0b0f !important;
}

body,
#root,
.app-shell,
.safe-area-wrapper,
.global-layout-content,
.m1-app-bg,
.min-h-screen {
  background: transparent !important;
  background-color: transparent !important;
}

/* Tutti i contenuti sopra il gradiente */
.app-shell > *:not(.m1-fullscreen-bg):not(.m1-grain) {
  position: relative;
  z-index: 1;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ”§ PWA MOBILE FIX: GPU Layer Promotion per elementi fixed
   Previene che il gradiente copra header/nav/pills durante scroll su iOS PWA
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

/* Gradiente background - layer base (z-index: 0, NON -1 per non andare dietro html) */
.m1-fullscreen-bg {
  z-index: 0 !important;
  pointer-events: none;
}

/* Fixed elements - forza GPU layer promotion per iOS PWA stability */
.unified-header-wrapper,
.bottom-navigation-ios,
/* Tailwind fixed pills (z-[9998], z-[9999], etc.) */
.fixed.z-\[9998\],
.fixed.z-\[9999\],
.fixed.z-\[10000\],
.fixed.z-40,
/* Inline style fixed elements as fallback */
header[style*="position: fixed"],
nav[style*="position: fixed"] {
  transform: translateZ(0) !important;
  -webkit-transform: translateZ(0) !important;
  backface-visibility: hidden !important;
  -webkit-backface-visibility: hidden !important;
  will-change: transform !important;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ğŸ¯ MICRO-MISSIONS HIGHLIGHT EFFECT
   âœ… FIX 23/12/2025: Evidenzia elementi durante le micro-missions
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.micro-mission-highlight {
  position: relative;
  z-index: 100;
  animation: micro-mission-pulse 2s ease-in-out infinite;
  box-shadow: 
    0 0 0 3px rgba(0, 255, 136, 0.6),
    0 0 20px rgba(0, 255, 136, 0.4),
    0 0 40px rgba(0, 255, 136, 0.2) !important;
  border-radius: 12px;
}

@keyframes micro-mission-pulse {
  0%, 100% {
    box-shadow: 
      0 0 0 3px rgba(0, 255, 136, 0.6),
      0 0 20px rgba(0, 255, 136, 0.4),
      0 0 40px rgba(0, 255, 136, 0.2);
  }
  50% {
    box-shadow: 
      0 0 0 5px rgba(0, 255, 136, 0.8),
      0 0 30px rgba(0, 255, 136, 0.6),
      0 0 60px rgba(0, 255, 136, 0.3);
  }
}

/* ==============================================
   ğŸ“± iOS KEYBOARD: Hide Bottom Nav (like Telegram)
   When keyboard is open, hide bottom navigation
   ROLLBACK: Remove this section
   ============================================== */
.m1-keyboard-open #m1-bottom-nav {
  display: none !important;
  visibility: hidden !important;
  opacity: 0 !important;
  pointer-events: none !important;
  height: 0 !important;
  overflow: hidden !important;
}

/* Remove bottom padding when keyboard is open to prevent layout jump */
.m1-keyboard-open .has-bottom-nav-padding {
  padding-bottom: 0 !important;
}

/* Smooth transition for bottom nav appearance */
#m1-bottom-nav {
  transition: opacity 0.15s ease-out, visibility 0.15s ease-out;
}

/* Â© 2025 Joseph MULÃ‰ â€“ M1SSIONâ„¢ â€“ ALL RIGHTS RESERVED â€“ NIYVORA KFTâ„¢ */
